(window.webpackJsonp=window.webpackJsonp||[]).push([[6,4,75,76],{305:function(e,t,n){var a=n(8);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,a,s){var r=null!=t?t:e.nullContext||{},i=e.hooks.helperMissing,o=e.escapeExpression,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="btn-group pull-right">\r\n    <button class="btn btn-link" id="revoke" type="button" title="'+o((l(n,"t")||t&&l(t,"t")||i).call(r,"common.form.revoke",{name:"t",hash:{},data:s,loc:{start:{line:17,column:66},end:{line:17,column:92}}}))+'">\r\n        <i class="fa fa-trash-o"></i>\r\n    </button>\r\n    <button class="btn btn-link" id="save" type="button" title="'+o((l(n,"t")||t&&l(t,"t")||i).call(r,"common.form.save",{name:"t",hash:{},data:s,loc:{start:{line:20,column:64},end:{line:20,column:88}}}))+'">\r\n        <i class="fa fa-check"></i>\r\n    </button>\r\n    <button class="btn btn-link" id="cancel" type="button" title="'+o((l(n,"t")||t&&l(t,"t")||i).call(r,"common.form.cancel",{name:"t",hash:{},data:s,loc:{start:{line:23,column:66},end:{line:23,column:92}}}))+'">\r\n        <i class="fa fa-close"></i>\r\n    </button>\r\n</div>\r\n'},useData:!0})},306:function(e,t,n){var a=n(8);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,a,s){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<select multiple class='selectize'>\r\n    <option disabled selected value>"+e.escapeExpression((r(n,"t")||t&&r(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"common.form.pleaseSelect",{name:"t",hash:{},data:s,loc:{start:{line:17,column:36},end:{line:17,column:68}}}))+"</option>\r\n</select>\r\n"},useData:!0})},433:function(e,t,n){"use strict";var a=n(2),s=n.n(a),r=n(567),i=n.n(r);i.a.HeaderCell.prototype.render=function(){this.$el.empty();var e,t=this.column;return e=i.a.callByNeed(t.sortable(),t,this.collection)?s()("<a>").text(t.get("label")).append("<b class='sort-caret'></b>"):document.createTextNode(t.get("label")),this.$el.append(e),this.$el.attr("data-field",t.get("name")),this.$el.addClass(t.get("direction")),this.delegateEvents(),this},t.a=i.a},434:function(e,t,n){"use strict";n(29),n(30),n(31),n(39),n(101),n(129),n(102),n(22),n(110),n(50),n(15),n(130),n(28),n(26),n(40),n(236),n(569);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(433);o.a.Extension.ThemeableServerSideFilter=o.a.Extension.ServerSideFilter.extend({events:s.a.extend(o.a.Extension.ServerSideFilter.prototype.events,{"keyup input[type=search]":"keyupSearch"}),keyupSearch:function(e){e.preventDefault(),this.showClearButtonMaybe(e),this.minimumSearchChars&&i()(e.target).val().length>=this.minimumSearchChars&&this.search(e)},className:"form-group has-feedback",template:function(e){var t=e.placeholder?'placeholder="'.concat(e.placeholder,'"'):"",n=e.value?'value="'.concat(e.value,'"'):"";return'<input class="form-control input-sm" type="search" '.concat(t,' name="').concat(e.name,'" ').concat(n,"/>")+"<a class='fa fa-times form-control-feedback' data-backgrid-action='clear' role='button' href='#'></a>"}});o.a.Extension.ThemeableServerSideFilter;var l=n(73),c=n.n(l),d=n(432),u=n.n(d),h=n(86),f=n(23);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var m={};m.DatetimeAgoCell=o.a.Cell.extend({className:"date-time-ago-cell",formatter:{fromRaw:function(e){return u()(e).fromNow()}},render:function(){return m.DatetimeAgoCell.__super__.render.apply(this),this.$el.attr("title",u()(this.model.get(this.column.get("name"))).format("Do MMMM YYYY, h:mm:ssa")),this}}),m.ArrayCell=o.a.Cell.extend({className:"array-formatter-cell",buildHtml:function(e){for(var t="<ul>",n=0;n<e.length;n++)s.a.isString(e[n])?t+="<li>".concat(e[n],"</li>"):t+="<li>".concat(JSON.stringify(e[n]),"</li>");return t+="</ul>"},render:function(){this.$el.empty();var e=this.model.get(this.column.attributes.name);return this.$el.append(this.buildHtml(e)),this.delegateEvents(),this}}),m.ObjectCell=o.a.Cell.extend({className:"object-formatter-cell",render:function(){this.$el.empty();var e,t=this.model.get(this.column.attributes.name),n='<dl class="dl-horizontal">';for(e in t)s.a.isString(t[e])?n+="<dt>".concat(e,"</dt><dd>").concat(t[e],"</dd>"):n+="<dt>".concat(e,"</dt><dd>").concat(JSON.stringify(t[e]),"</dd>");return n+="</dl>",this.$el.append(n),this.delegateEvents(),this}}),m.UniversalIdToUsername=o.a.Cell.extend({formatter:{fromRaw:function(e){return e.substring(3,e.indexOf(",ou=user"))}},render:function(){return m.UniversalIdToUsername.__super__.render.apply(this),this.$el.attr("title",this.model.get(this.column.get("name"))),this}}),m.ClickableRow=o.a.Row.extend({events:{click:"onClick",keyup:"onKeyup"},onKeyup:function(e){13===e.keyCode&&this.callback&&this.callback(e)},onClick:function(e){this.callback&&this.callback(e)}}),m.TemplateCell=o.a.Cell.extend({className:"template-cell",render:function(){var e=this.template(this.model);return this.$el.html(e),this.rendered&&this.rendered(),this.delegateEvents(),this}}),m.ClassHeaderCell=o.a.HeaderCell.extend({className:"",render:function(){return m.ClassHeaderCell.__super__.render.apply(this),this.delegateEvents(),this}}),m.UriExtCell=o.a.UriCell.extend({events:{click:"gotoUrl"},render:function(){this.$el.empty();var e=this.model.get(this.column.get("name")),t=this.formatter.fromRaw(e,this.model),n=s.a.isFunction(this.column.get("href"))?this.column.get("href")(e,t,this.model):this.column.get("href");return this.$el.append(i()("<a>",{href:n||e,title:this.title||t}).text(t)),n&&(this.$el.data("href",n),this.$el.prop("title",this.title||t)),this.delegateEvents(),this},gotoUrl:function(e){e.preventDefault();var t=i()(e.currentTarget).data("href");f.a.navigate(t,{trigger:!0})}}),m.FilterHeaderCell=o.a.HeaderCell.extend({className:"filter-header-cell enable-pointer",render:function(){var e=new o.a.Extension.ThemeableServerSideFilter({name:this.column.get("name"),placeholder:i.a.t("common.form.filter"),collection:this.collection});return this.addClassName&&this.$el.addClass(this.addClassName),this.collection.state.filters=this.collection.state.filters?this.collection.state.filters:[],this.collection.state.filters.push(e),m.FilterHeaderCell.__super__.render.apply(this),this.$el.prepend(e.render().el),this}}),m.queryFilter=function(e){void 0===e&&(e={});var t=[],n=e._queryFilter||[],a=e&&e.filterName&&"eq"===e.filterName?function(e,t){return"".concat(e,"+eq+").concat(encodeURIComponent('"*'.concat(t,'*"')))}:function(e,t){return"".concat(e,"+co+").concat(encodeURIComponent('"'.concat(t,'"')))};return s.a.each(this.state.filters,function(e){""!==e.query()&&t.push(a(e.name,e.query()))}),0===(t=t.concat(n)).length||t.join("+AND+")},m.parseState=function(e){return this.state.totalRecords||(this.state.totalRecords=e.remainingPagedResults+e.resultCount),this.state.totalPages||(this.state.totalPages=Math.ceil(this.state.totalRecords/this.state.pageSize)),this.state},m.pagedResultsOffset=function(){return(this.state.currentPage-1)*this.state.pageSize},m.sortKeys=function(){return 1===this.state.order?"-".concat(this.state.sortKey):this.state.sortKey},m.sync=function(e,t,n){var a=[],r=["_pageSize","_pagedResultsOffset","_sortKeys"];return"*"===n.data._queryId&&!0===n.data._queryFilter?r.push("_queryId"):r.push("_queryFilter"),s.a.forIn(n.data,function(e,t){s.a.includes(r,t)&&a.push("".concat(t,"=").concat(e))}),n.data=a.join("&"),n.processData=!1,n.beforeSend||(n.beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")}),n.error=function(e){h.a.addMessage({type:h.a.TYPE_DANGER,response:e})},c.a.sync(e,t,n)},m.parseRecords=function(e){return e.result},m.getQueryParams=function(e){return e=e||{},{_sortKeys:this.sortKeys,_queryFilter:function(){return m.queryFilter.call(this,e)},pageSize:"_pageSize",_pagedResultsOffset:this.pagedResultsOffset}},m.doubleSortFix=function(e){var t=e.cid,n=e.collection.filter(function(e){return e.cid!==t});s.a.each(n,function(e){e.set("direction",null)})},m.getState=function(e){var t={pageSize:20,sortKey:"name"};return e&&"object"===p(e)&&s.a.extend(t,e),t};t.a=m},435:function(e,t,n){"use strict";n(50),n(577);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(73),l=n.n(o);t.a=l.a.RelationalModel.extend({parse:function(e){return s.a.isUrl(e.id)?e=this.resolve(e.id):e.name=e.id,e},resolve:function(e){var t={id:e,name:e};return i.a.ajax({async:!1,dataType:"json",success:function(e){t.name=e.name,t.icon_uri=e.icon_uri},url:e}),t},sync:function(e,t,n){return n.beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")},l.a.Model.prototype.sync.call(this,e,t,n)}})},563:function(e,t,n){"use strict";var a=n(73),s=n.n(a),r=n(435);t.a=s.a.RelationalModel.extend({idAttribute:"subject",relations:[{type:s.a.HasMany,key:"scopes",relatedModel:r.a,includeInJSON:s.a.Model.prototype.idAttribute,parse:!0}],validate:function(e){return e.subject?e.scopes&&e.scopes.length?void 0:"no scopes":"no subject"}})},564:function(e,t,n){"use strict";n(39),n(109);var a=n(0),s=n.n(a),r=n(201),i=n(3),o=n(5),l=n(134),c=new r.a("".concat(o.a.host).concat(o.a.context,"/json"));c.getUmaConfig=function(){return c.serviceCall({url:Object(l.a)("/serverinfo/uma"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(e){return i.a.globalData.auth.uma=i.a.globalData.auth.uma||{},i.a.globalData.auth.uma.enabled=e.enabled,i.a.globalData.auth.uma.resharingMode=e.resharingMode,e})},c.unshareAllResources=function(){var e=encodeURIComponent(i.a.loggedUser.get("username"));return c.serviceCall({url:Object(l.a)("/users/".concat(e,"/oauth2/resources/sets?_action=revokeAll")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})},c.approveRequest=function(e,t){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/uma/pendingrequests/").concat(e,"?_action=approve")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({scopes:t})})},c.denyRequest=function(e){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/uma/pendingrequests/").concat(e,"?_action=deny")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})},c.labels={all:function(){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/oauth2/resources/labels?_queryFilter=true")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},create:function(e,t){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/oauth2/resources/labels?_action=create")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({name:e,type:t})})},get:function(e){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/oauth2/resources/labels?_queryFilter=true")),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(t){return s.a.find(t.result,{_id:e})})},remove:function(e){return c.serviceCall({url:Object(l.a)("/users/".concat(encodeURIComponent(i.a.loggedUser.get("username")),"/oauth2/resources/labels/").concat(encodeURIComponent(e))),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"DELETE"})}},t.a=c},565:function(e,t,n){"use strict";n(39),n(129),n(43),n(130);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(73),l=n.n(o),c=n(3),d=n(5),u=n(134),h=n(563),f=l.a.RelationalModel.extend({idAttribute:"policyId",toBeCreated:!0,relations:[{type:l.a.HasMany,key:"permissions",relatedModel:h.a}],parse:function(e){return s.a.isEmpty(e.permissions)||(this.toBeCreated=!1),e},sync:function(e,t,n){return(n=n||{}).beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")},"update"===e.toLowerCase()&&!0===t.toBeCreated&&(t.toBeCreated=!1,n.headers={},n.headers["If-None-Match"]="*"),t.get("permissions").length||(t.toBeCreated=!0),l.a.Model.prototype.sync.call(this,e,t,n)},urlRoot:"".concat(d.a.host).concat(d.a.context,"/json").concat(Object(u.a)("/users/".concat(c.a.loggedUser.get("username"),"/uma/policies")))}),p=n(435);t.a=l.a.RelationalModel.extend({fetch:function(){var e=i.a.Deferred();return l.a.RelationalModel.prototype.fetch.call(this,{success:function(t){e.resolve(t)},error:function(t,n){e.reject(n)}}),e.promise()},idAttribute:"_id",parse:function(e){return e.policy||(e.policy={},e.policy.permissions=[]),e.policy.policyId=e._id,e.scopes=s.a.map(e.scopes,function(e){return{id:e}}),e},relations:[{type:l.a.HasOne,key:"policy",relatedModel:f,parse:!0},{type:l.a.HasMany,key:"scopes",relatedModel:p.a,includeInJSON:l.a.Model.prototype.idAttribute,parse:!0}],toggleStarred:function(e){s.a.includes(this.get("labels"),e)?this.set("labels",s.a.reject(this.get("labels"),function(t){return t===e})):this.get("labels").push(e)},urlRoot:"".concat(d.a.host).concat(d.a.context,"/json").concat(Object(u.a)("/users/".concat(c.a.loggedUser.get("username"),"/oauth2/resources/sets")))})},568:function(e,t,n){"use strict";n(39),n(109),n(110),n(382),n(50),n(56),n(383),n(571);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(106),l=n(433),c=n(434),d=n(381),u=n(5),h=n(20),f=(n(129),n(102),n(51),n(40),n(130),n(85),n(74),n(3)),p=n(37),m={decorateURLWithOverrideRealm:function(e){var t,n,a,s=m.getOverrideRealm();if(s){if(-1!==e.indexOf("realm="))return e;-1!==(n=e.indexOf("#"))&&(a=e.slice(n),e=e.slice(0,n)),t=-1===e.indexOf("?")?"?":"&",e="".concat(e).concat(t,"realm=").concat(s),a&&(e+=a)}return e},decorateURIWithRealm:function(e){return e=m.decorateURIWithSubRealm(e),e=m.decorateURLWithOverrideRealm(e)},decorateURIWithSubRealm:function(e){var t=f.a.globalData,n=t&&t.auth?t.auth.subRealm:"",a=n?"".concat(n,"/"):"";return t&&t.auth&&(void 0===t.auth.subRealm||null===t.auth.subRealm)&&console.warn("Unable to decorate URI, Configuration.globalData.auth.subRealm not yet set"),e=e.replace("__subrealm__/",a)},getRealm:function(){var e=m.getOverrideRealm()||m.getSubRealm();return"/"===e.substring(0,1)?e.substring(1):e},getOverrideRealm:function(){var e=p.a.parseQueryString(p.a.getCurrentQueryString()).realm,t=p.a.parseQueryString(p.a.getCurrentFragmentQueryString()).realm;return e||t},getSubRealm:function(){var e,t=p.a.getCurrentFragment().split("/"),n=t.shift().split("&")[0];return e=n&&s.a.includes(["login","passwordReset","continuePasswordReset","register","continueRegister"],n)?"/"===(e=t.join("/").split("&")[0]).slice(-1)?e.slice(0,-1):e:f.a.globalData.auth.subRealm?f.a.globalData.auth.subRealm:""},encodeRealm:function(e){var t=[],n=e.split("/");return s.a.each(n,function(e){""!==e&&t.push(encodeURIComponent(e))}),"/".concat(t.join("/"))}},g=m,b=new(o.a.extend({template:"user/uma/views/share/ShareCounter",element:"#shareCounter",render:function(e,t){this.data.shareCount=e,this.data.shareInfo=this.getShareInfo(e),this.data.shareIcon=this.getShareIcon(e),this.parentRender(function(){t&&t()})},getShareInfo:function(e){var t=e?{count:e}:{context:"none"};return i.a.t("uma.share.info",t)},getShareIcon:function(e){var t="fa fa-lock";return 1===e?t="fa fa-user":e>1&&(t="fa fa-users"),t}})),v=n(563),y=n(435),j=n(565),C=/[?&]realm=/,S=/\/json\/users\/[^/]+\/uma\/policies/,R=/\/json\/users\/[^/]+\/oauth2\/resourcesets/;i.a.ajaxPrefilter(function(e){(S.test(e.url)||R.test(e.url))&&!C.test(e.url)&&g.getOverrideRealm()&&(e.url=g.decorateURLWithOverrideRealm(e.url))});var k=o.a.extend({initialize:function(){this.parentModel=null},template:"user/uma/views/share/CommonShare",events:{"click input#shareButton":"save"},enableOrDisableShareButton:function(){var e=this.$el.find("#selectUser select")[0].selectize.getValue().length>0,t=this.$el.find("#selectPermission select")[0].selectize.getValue().length>0;this.$el.find("input#shareButton").prop("disabled",!(e&&t))},onParentModelError:function(e,t){console.error("Unrecoverable load failure UMAResourceSetWithPolicy. ".concat(t.responseJSON.code," (").concat(t.responseJSON.reason,") ").concat(t.responseJSON.message))},onParentModelSync:function(e){e.get("policy").set("policyId",this.parentModel.id),this.render()},syncParentModel:function(e){var t=!this.parentModel||e&&this.parentModel.id!==e;return t&&(this.stopListening(this.parentModel),this.parentModel=j.a.findOrCreate({_id:e}),this.listenTo(this.parentModel,"sync",this.onParentModelSync),this.listenTo(this.parentModel,"error",this.onParentModelError),this.parentModel.fetch()),t},renderDialog:function(e,t){var n=this,a=i()("<div></div>"),s=e._id||e,r={type:d.a.TYPE_PRIMARY,title:i.a.t("uma.share.shareResource"),size:d.a.SIZE_WIDE,cssClass:"shareDialog",message:a,buttons:[{label:i.a.t("common.form.close"),cssClass:"btn-default",action:function(e){e.close()}}],onshow:function(){n.element=a,n.render(s,t)},onshown:function(){n.renderShareCounter(t)}};this.toBeCreated=e.toBeCreated,this.afterShare=e.share,d.a.show(r)},render:function(e,t){var n=this;if(e instanceof Array&&(e=e[0]),!this.syncParentModel(e)){this.data={},this.data.name=this.parentModel.get("name"),this.data.icon=this.parentModel.get("icon_uri"),this.data.scopes=this.parentModel.get("scopes").toJSON();var a=this.parentModel.get("policy").get("permissions");this.data.permissions=a.toJSON();var s=new l.a.Grid({columns:[{name:"subject",label:i.a.t("uma.resources.show.grid.0"),cell:"string",editable:!1,headerCell:c.a.ClassHeaderCell.extend({className:"col-md-6"})},{name:"scopes",label:i.a.t("uma.resources.show.grid.2"),cell:l.a.Cell.extend({render:function(){var e=this.model.get("scopes").pluck("name").join(", ");return this.$el.empty(),this.$el.append(e),this.delegateEvents(),this}}),editable:!1,headerCell:c.a.ClassHeaderCell.extend({className:"col-md-6"})}],collection:a,emptyText:i.a.t("console.common.noResults"),className:"backgrid table"});this.parentRender(function(){n.renderUserOptions(),n.renderPermissionOptions(),n.renderShareCounter(t),n.$el.find("#advancedView").append(s.render().el),n.$el.find("#umaShareImage img").error(function(){i()(this).parent().addClass("fa-file-image-o no-image")})})}},renderPermissionOptions:function(){var e=this;this.$el.find("#selectPermission select").selectize({plugins:["restore_on_backspace"],delimiter:!1,persist:!1,create:!1,hideSelected:!0,onChange:function(){e.enableOrDisableShareButton()}})},renderUserOptions:function(){var e=this;this.$el.find("#selectUser select").selectize({addPrecedence:!0,create:!0,onChange:function(t){var n,a=e.parentModel.get("policy").get("permissions").findWhere({subject:t}),s=e.$el.find("#selectPermission select");a&&(n=a.get("scopes").pluck("name"),s[0].selectize.focus(),s[0].selectize.setValue(n)),e.enableOrDisableShareButton()}})},reset:function(){this.$el.find("#selectUser select")[0].selectize.clear(),this.$el.find("#selectPermission select")[0].selectize.clear(),this.$el.find("input#shareButton").prop("disabled",!0),this.renderShareCounter()},save:function(){var e=this,t=this.parentModel.get("policy").get("permissions"),n=this.$el.find("#selectUser select")[0].selectize.getValue(),a=s.a.each(this.$el.find("#selectPermission select")[0].selectize.getValue(),function(e){return y.a.find({id:e})}),r=[];s.a.forEach(n,function(e){var n=v.a.findOrCreate({subject:e,scopes:a});t.add(n),r.push(n)});var i=this.parentModel.get("policy");this.toBeCreated&&(i.toBeCreated=this.toBeCreated),i.save().then(function(){h.a.sendEvent(u.a.EVENT_DISPLAY_MESSAGE_REQUEST,"policyCreatedSuccess"),e.reset()},function(e){e.status&&500===e.status&&s.a.forEach(r,function(e){t.remove(e)}),h.a.sendEvent(u.a.EVENT_DISPLAY_MESSAGE_REQUEST,"policyCreatedFail")}).always(function(){e.toBeCreated=!1,e.afterShare&&e.afterShare()})},renderShareCounter:function(e){var t=this.parentModel.get("policy"),n=t?t.get("permissions").length:0;b.render(n,e)}});t.a=k},570:function(e,t,n){var a={"./af":436,"./af.js":436,"./ar":437,"./ar-dz":438,"./ar-dz.js":438,"./ar-kw":439,"./ar-kw.js":439,"./ar-ly":440,"./ar-ly.js":440,"./ar-ma":441,"./ar-ma.js":441,"./ar-sa":442,"./ar-sa.js":442,"./ar-tn":443,"./ar-tn.js":443,"./ar.js":437,"./az":444,"./az.js":444,"./be":445,"./be.js":445,"./bg":446,"./bg.js":446,"./bm":447,"./bm.js":447,"./bn":448,"./bn.js":448,"./bo":449,"./bo.js":449,"./br":450,"./br.js":450,"./bs":451,"./bs.js":451,"./ca":452,"./ca.js":452,"./cs":453,"./cs.js":453,"./cv":454,"./cv.js":454,"./cy":455,"./cy.js":455,"./da":456,"./da.js":456,"./de":457,"./de-at":458,"./de-at.js":458,"./de-ch":459,"./de-ch.js":459,"./de.js":457,"./dv":460,"./dv.js":460,"./el":461,"./el.js":461,"./en-SG":462,"./en-SG.js":462,"./en-au":463,"./en-au.js":463,"./en-ca":464,"./en-ca.js":464,"./en-gb":465,"./en-gb.js":465,"./en-ie":466,"./en-ie.js":466,"./en-il":467,"./en-il.js":467,"./en-nz":468,"./en-nz.js":468,"./eo":469,"./eo.js":469,"./es":470,"./es-do":471,"./es-do.js":471,"./es-us":472,"./es-us.js":472,"./es.js":470,"./et":473,"./et.js":473,"./eu":474,"./eu.js":474,"./fa":475,"./fa.js":475,"./fi":476,"./fi.js":476,"./fo":477,"./fo.js":477,"./fr":478,"./fr-ca":479,"./fr-ca.js":479,"./fr-ch":480,"./fr-ch.js":480,"./fr.js":478,"./fy":481,"./fy.js":481,"./ga":482,"./ga.js":482,"./gd":483,"./gd.js":483,"./gl":484,"./gl.js":484,"./gom-latn":485,"./gom-latn.js":485,"./gu":486,"./gu.js":486,"./he":487,"./he.js":487,"./hi":488,"./hi.js":488,"./hr":489,"./hr.js":489,"./hu":490,"./hu.js":490,"./hy-am":491,"./hy-am.js":491,"./id":492,"./id.js":492,"./is":493,"./is.js":493,"./it":494,"./it-ch":495,"./it-ch.js":495,"./it.js":494,"./ja":496,"./ja.js":496,"./jv":497,"./jv.js":497,"./ka":498,"./ka.js":498,"./kk":499,"./kk.js":499,"./km":500,"./km.js":500,"./kn":501,"./kn.js":501,"./ko":502,"./ko.js":502,"./ku":503,"./ku.js":503,"./ky":504,"./ky.js":504,"./lb":505,"./lb.js":505,"./lo":506,"./lo.js":506,"./lt":507,"./lt.js":507,"./lv":508,"./lv.js":508,"./me":509,"./me.js":509,"./mi":510,"./mi.js":510,"./mk":511,"./mk.js":511,"./ml":512,"./ml.js":512,"./mn":513,"./mn.js":513,"./mr":514,"./mr.js":514,"./ms":515,"./ms-my":516,"./ms-my.js":516,"./ms.js":515,"./mt":517,"./mt.js":517,"./my":518,"./my.js":518,"./nb":519,"./nb.js":519,"./ne":520,"./ne.js":520,"./nl":521,"./nl-be":522,"./nl-be.js":522,"./nl.js":521,"./nn":523,"./nn.js":523,"./pa-in":524,"./pa-in.js":524,"./pl":525,"./pl.js":525,"./pt":526,"./pt-br":527,"./pt-br.js":527,"./pt.js":526,"./ro":528,"./ro.js":528,"./ru":529,"./ru.js":529,"./sd":530,"./sd.js":530,"./se":531,"./se.js":531,"./si":532,"./si.js":532,"./sk":533,"./sk.js":533,"./sl":534,"./sl.js":534,"./sq":535,"./sq.js":535,"./sr":536,"./sr-cyrl":537,"./sr-cyrl.js":537,"./sr.js":536,"./ss":538,"./ss.js":538,"./sv":539,"./sv.js":539,"./sw":540,"./sw.js":540,"./ta":541,"./ta.js":541,"./te":542,"./te.js":542,"./tet":543,"./tet.js":543,"./tg":544,"./tg.js":544,"./th":545,"./th.js":545,"./tl-ph":546,"./tl-ph.js":546,"./tlh":547,"./tlh.js":547,"./tr":548,"./tr.js":548,"./tzl":549,"./tzl.js":549,"./tzm":550,"./tzm-latn":551,"./tzm-latn.js":551,"./tzm.js":550,"./ug-cn":552,"./ug-cn.js":552,"./uk":553,"./uk.js":553,"./ur":554,"./ur.js":554,"./uz":555,"./uz-latn":556,"./uz-latn.js":556,"./uz.js":555,"./vi":557,"./vi.js":557,"./x-pseudo":558,"./x-pseudo.js":558,"./yo":559,"./yo.js":559,"./zh-cn":560,"./zh-cn.js":560,"./zh-hk":561,"./zh-hk.js":561,"./zh-tw":562,"./zh-tw.js":562};function s(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=r,e.exports=s,s.id=570},596:function(e,t,n){"use strict";n.r(t);n(101),n(109),n(102),n(110),n(50),n(40),n(74);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(23),l=(n(51),n(579)),c=n.n(l),d=n(584),u=n.n(d),h=n(106),f=n(62),p=n(37),m=h.a.extend({events:{"click .sidenav a[href]:not([data-toggle]):not([data-event])":"navigateToPage"},findContentElement:function(){return this.$el.find("#sidePageContent")[0]},findActiveNavItem:function(e){var t=this.$el.find('.sidenav ol > li > a[href^="#'.concat(e,'"]'));if(t.length){var n=t.parent();n.addClass("active"),n.parentsUntil(this.$el.find(".sidenav"),"ol.collapse").addClass("in").attr("aria-expanded","true").parent().addClass("active")}else{var a=e.split("/");this.findActiveNavItem(a.slice(0,-1).join("/"))}},navigateToPage:function(){this.renderSidePageContentOnly=!0},setElement:function(e){var t=this;h.a.prototype.setElement.call(this,e),this.route&&this.renderSidePageContentOnly&&this.route.page().then(s.a.bind(function(e){t.renderPage(e,t.args)},this),s.a.bind(function(){throw"Unable to render page for module ".concat(t.route.page)},this))},render:function(e,t){var n=this;this.args=e;var a=this.findContentElement();a&&u.a.unmountComponentAtNode(a);var s=function(){n.$el.find(".sidenav li").removeClass("active"),n.findActiveNavItem(p.a.getCurrentFragment()),n.route.page().then(f.a).then(function(t){n.renderPage(t,e)}),t&&t()};this.renderSidePageContentOnly?s():this.parentRender(function(){s()})},renderPage:function(e,t,n){if(e.prototype instanceof h.a){var a=new e;a.element="#sidePageContent",a.render(t,n),this.delegateEvents()}else{if(!function(e){return e.prototype instanceof c.a.Component||e.WrappedComponent||s.a.isFunction(e)}(e))throw new Error("[TreeNavigation] Unable to determine page type (Backbone or React).");u.a.render(c.a.createElement(e),this.findContentElement())}this.renderSidePageContentOnly=!1}}),g=n(564),b=m.extend({template:"user/uma/views/resource/LabelTreeNavigationTemplate",partials:{"uma/_NestedList":"uma/_NestedList"},findActiveNavItem:function(e){var t=o.a.configuration.routes.umaResourcesMyLabelsResource,n=o.a.currentRoute===t?s.a.initial(e.split("/")).join("/"):e,a=this.$el.find(".sidenav ol > li > a[href='#".concat(n,"']"));a.length&&(this.$el.find(".sidenav ol").removeClass("in"),a.parentsUntil(this.$el.find(".sidenav"),"ol.collapse").addClass("in").parent().children("span[data-toggle]").attr("aria-expanded","true"),a.parent().addClass("active"),"false"===a.attr("aria-expanded")&&a.attr("aria-expanded","true"))},navigateToPage:function(e){this.$el.find(".sidenav li").removeClass("active"),i()(e.currentTarget).addClass("active"),this.renderSidePageContentOnly=!0},render:function(e,t){var n,a,r=this;this.args=e,this.callback=t,g.a.labels.all().then(function(i){s.a.some(i.result,function(e){return"starred"===e.name.toLowerCase()})||g.a.labels.create("starred","STAR"),n=s.a.filter(i.result,function(e){return"user"===e.type.toLowerCase()}),a=s.a.sortBy(n,function(e){return e.name}),r.data.labels={starred:s.a.filter(i.result,function(e){return"starred"===e.type.toLowerCase()}),system:s.a.filter(i.result,function(e){return"system"===e.type.toLowerCase()}),user:a},r.data.nestedLabels=[],s.a.each(r.data.labels.user,function(e){r.addToParent(r.data.nestedLabels,e)}),m.prototype.render.call(r,e,t)})},addToParent:function(e,t){if(-1===t.name.indexOf("/"))t.title=t.name,t.children=[],t.viewId=s.a.uniqueId("viewId_"),e.push(t);else{var n,a=t.name.split("/"),r=a.shift();t.name=a.join("/"),(n=s.a.find(e,{title:r}))||(n={title:r,children:[],viewId:s.a.uniqueId("viewId_")},e.push(n)),this.addToParent(n.children,t)}},addUserLabels:function(e){var t=this;this.data.nestedLabels=[],this.data.labels.user=s.a.sortBy(e,function(e){return e.name}),s.a.each(this.data.labels.user,function(e){t.addToParent(t.data.nestedLabels,e)}),this.renderSidePageContentOnly=!0,m.prototype.render.call(this,this.args,this.callback)}});t.default=new b},662:function(e,t,n){"use strict";n.r(t);n(29),n(30),n(31),n(39),n(101),n(109),n(127),n(129),n(22),n(43),n(51),n(382),n(50),n(15),n(45),n(130),n(28),n(26),n(383),n(571);var a=n(0),s=n.n(a),r=n(2),i=n.n(r),o=n(73),l=n.n(o),c=n(106),d=n(433),u=n(434),h=n(381),f=n(568),p=n(5),m=n(20),g=n(596),b=n(86),v=n(305),y=n.n(v),j=n(306),C=n.n(j),S=n(565),R=n(564);function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,s,r,i,o=[],l=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=r.call(n)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function _(e){return"USER"===e.type}function w(e,t){return s.a.find(e,function(e){return e._id===t})}function P(e,t){return s.a.find(e,function(e){return e.name===t})}function L(){return R.a.labels.all().then(function(e){return e.result})}var E=c.a.extend({initialize:function(){this.model=null},template:"user/uma/views/resource/ResourceTemplate",selectizeTemplate:C.a,events:{"click button#starred":"onToggleStarred","click button#share":"onShare","click li#unshare":"onUnshare","click button#editLabels":"editLabels","click .page-toolbar .selectize-input.disabled":"editLabels","click button#saveLabels":"submitLabelsChanges","click button#discardLabels":"discardLabelsChanges"},onModelError:function(e,t){console.error("Unrecoverable load failure UMAResourceSetWithPolicy. ".concat(t.responseJSON.code," (").concat(t.responseJSON.reason,")").concat(t.responseJSON.message))},onModelChange:function(e){this.render([void 0,e.get("_id")])},onUnshare:function(e){if(i()(e.currentTarget).hasClass("disabled"))return!1;e.preventDefault();var t=this;h.a.show({type:h.a.TYPE_DANGER,title:t.model.get("name"),message:i.a.t("uma.resources.show.revokeAllMessage"),closable:!1,buttons:[{label:i.a.t("common.form.cancel"),action:function(e){e.close()}},{id:"btnOk",label:i.a.t("common.form.ok"),cssClass:"btn-primary btn-danger",action:function(e){e.enableButtons(!1),e.getButton("btnOk").text(i.a.t("common.form.working")),t.model.get("policy").destroy().then(function(){m.a.sendEvent(p.a.EVENT_DISPLAY_MESSAGE_REQUEST,"revokeAllPoliciesSuccess"),t.onModelChange(t.model),t.model.toBeCreated=!0},function(e){b.a.addMessage({response:e,type:b.a.TYPE_DANGER})}).always(function(){e.close()})}}]})},onShare:function(){var e=this;(new f.a).renderDialog({_id:this.model.id,toBeCreated:this.model.toBeCreated,share:function(){e.model.toBeCreated=!1,e.updateUnshareButton()}})},onToggleStarred:function(){var e=this,t=s.a.find(this.allLabels,{type:"STAR"})._id,n=e.$el.find("#starred"),a=n.find("i");e.model.toggleStarred(t),a.removeClass("fa-star-o fa-star"),a.addClass("fa-refresh fa-spin"),n.attr("disabled",!0),e.model.save().always(function(){var r=s.a.includes(e.model.get("labels"),t);n.attr("disabled",!1),a.removeClass("fa-refresh fa-spin"),a.addClass(r?"fa-star":"fa-star-o")})},renderLabelsOptions:function(){var e=this;this.$el.find("#labels select").selectize({plugins:["restore_on_backspace"],delimiter:!1,persist:!1,create:!0,hideSelected:!0,onChange:function(){e.$el.find("button#saveLabels").prop("disabled",!1)},render:{item:function(e){return'<div data-value="'.concat(e.name,'" class="item">').concat(e.name,'</div>"')}},labelField:"name",valueField:"name",searchField:["name"]})[0].selectize.disable(),this.updateLabelOptions(),this.$el.find(".page-toolbar .btn-group").hide()},updateLabelOptions:function(){var e=this.getLabelSelectize(),t=s.a.filter(this.allLabels,_),n=s()(this.model.get("labels")).map(s.a.partial(w,this.allLabels)).filter(_).sortBy("name").map("name").value();e.clearOptions(),e.addOption(t),e.clear(),s.a.each(n,function(t){e.addItem(t)})},renderSelectizeCell:function(){var e=i.a.Deferred(),t=this.selectizeTemplate({}),n=d.a.Cell.extend({className:"selectize-cell",render:function(){this.$el.html(t);var e=this.$el.find("select").selectize({create:!1,delimiter:!1,dropdownParent:"#uma",hideSelected:!0,persist:!1,labelField:"name",valueField:"id",items:this.model.get("scopes").pluck("name"),options:this.model.get("scopes").toJSON()})[0];return e.selectize.disable(),e.selectize.positionDropdown=function(){var e=this.$control,t=this.settings.dropdownParent?e.offset():e.position();this.settings.dropdownParent?(t.top-=2*e.outerHeight(!0)+i()(this.settings.dropdownParent).position().top,t.left-=i()(this.settings.dropdownParent).offset().left+i()(this.settings.dropdownParent).outerWidth()-i()(this.settings.dropdownParent).outerWidth(!0)):t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},this.delegateEvents(),this}});return e.resolve(n),e},render:function(e,t){var n=s.a.last(e),a=this;this.model&&this.id===n?this.isCurrentlyFetchingData||this.renderWithModel(t):(this.isCurrentlyFetchingData=!0,Promise.all([L(),S.a.findOrCreate({_id:n}).fetch()]).then(function(e){var n=k(e,2),s=n[0],r=n[1];r.id===a.id&&(a.allLabels=s,a.model=r,a.isCurrentlyFetchingData=!1,a.renderWithModel(t))},this.onModelError)),this.id=n},renderWithModel:function(e){var t,n,a=this;this.data={},this.data.name=this.model.get("name"),this.data.icon=this.model.get("icon_uri");var r=u.a.TemplateCell.extend({template:y.a,events:{"click #revoke":"revoke"},revoke:function(){a.model.get("policy").get("permissions").remove(this.model),a.model.get("policy").save().then(function(){a.onModelChange(a.model)})},className:"fr-col-btn-1"});t=new l.a.Collection,this.model.has("policy")&&(t=this.model.get("policy").get("permissions")),this.renderSelectizeCell().then(function(o){n=new d.a.Grid({columns:[{name:"subject",label:i.a.t("uma.resources.show.grid.0"),cell:"string",editable:!1},{name:"permissions",label:i.a.t("uma.resources.show.grid.2"),cell:o,editable:!1,sortable:!1},{name:"edit",label:"",cell:r,editable:!1,sortable:!1,headerCell:u.a.ClassHeaderCell.extend({className:"fr-col-btn-1"})}],collection:t,emptyText:i.a.t("console.common.noResults"),className:"backgrid table"}),a.parentRender(function(){a.$el.find('[data-toggle="tooltip"]').tooltip(),a.renderLabelsOptions(),a.updateUnshareButton(),a.$el.find(".table-container").append(n.render().el),a.$el.find("#umaShareImage img").error(function(){i()(this).parent().addClass("fa-file-image-o no-image")});var t=s.a.find(this.allLabels,{type:"STAR"});s.a.includes(this.model.get("labels"),t._id)&&a.$el.find("#starred i").toggleClass("fa-star-o fa-star"),e&&e()})})},getLabelSelectize:function(){return this.$el.find("#labels select")[0].selectize},stopEditingLabels:function(){this.getLabelSelectize().disable(),this.$el.find(".page-toolbar .btn-group").hide(),this.$el.find("#editLabels").show(),this.$el.find("#labels .selectize-control").addClass("pull-left")},editLabels:function(){var e=this.getLabelSelectize();e.enable(),e.focus(),this.$el.find("#editLabels").hide(),this.$el.find("#labels .selectize-control").removeClass("pull-left"),this.$el.find("button#saveLabels").prop("disabled",!0),this.$el.find("button#discardLabels").prop("disabled",!1),this.$el.find(".page-toolbar .btn-group").show()},disableLabelControls:function(){this.getLabelSelectize().disable(),this.$el.find("button#saveLabels").prop("disabled",!0),this.$el.find("button#discardLabels").prop("disabled",!0)},enableLabelControls:function(){this.getLabelSelectize().enable(),this.$el.find("button#saveLabels").prop("disabled",!1),this.$el.find("button#discardLabels").prop("disabled",!1)},submitLabelsChanges:function(){var e,t,n=this,a=this.getLabelSelectize().getValue(),r=s.a.filter(this.allLabels,_),i=s.a.map(r,"name"),o=s.a.difference(a,i),l=s.a.intersection(a,i),c=s()(l).map(s.a.partial(P,r)).map("_id").value(),d=s()(n.model.get("labels")).map(s.a.partial(w,this.allLabels)).reject(_).map("_id").value(),u=c.concat(d);n.disableLabelControls(),(e=o,t=s.a.map(e,function(e){return R.a.labels.create(e,"USER")}),Promise.all(t).then(function(){return 1===t.length?[arguments[0]._id]:s.a.map(arguments,function(e){return e[0]._id})})).then(function(e){return n.model.set("labels",u.concat(e)),Promise.all([L(),n.model.save()])}).then(function(e){var t=k(e,1)[0];n.allLabels=t,n.enableLabelControls(),n.stopEditingLabels(),n.updateLabelOptions(),g.default.addUserLabels(s.a.filter(n.allLabels,_))},function(){n.enableLabelControls()})},discardLabelsChanges:function(){this.stopEditingLabels(),this.updateLabelOptions()},updateUnshareButton:function(){this.model.has("policy")&&this.model.get("policy").get("permissions").length>0&&this.$el.find("li#unshare").removeClass("disabled").find("a").attr("aria-disabled",!1)}});t.default=E}}]);
//# sourceMappingURL=6.fe0dca4dc1.js.map