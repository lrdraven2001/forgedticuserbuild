(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{644:function(e,a,t){"use strict";t.r(a);t(29),t(30),t(31),t(77),t(39),t(101),t(109),t(129),t(102),t(22),t(43),t(78),t(50),t(79),t(139),t(44),t(140),t(141),t(142),t(15),t(404),t(40),t(130),t(28),t(85),t(238),t(56),t(26);var n=t(0),r=t.n(n),i=t(2),o=t.n(i),l=t(393),s=t.n(l),c=t(14),u=t.n(c),g=t(19),p=t(293),d=t(204),m=t(106),f=t(387),b=t(3),h=t(5),v=t(292),y=t(145),k=t(187),w=t(394),P=t(395),S=t(86),O=t(20),C=t(84),D=t(399),T=t(385),j=function(e){var a=o.a.Deferred(),t=e&&e.submitContent||e||{};return D.a.login(t,function(e,t){Object(p.a)()?window.location.href=Object(p.f)():(b.a.setProperty("loggedUser",e),C.a.removeAnonymousDefaultHeaders(),b.a.globalData.xuiUserSessionValidationEnabled&&T.a.start(P.a,t),O.a.sendEvent(h.a.EVENT_HANDLE_DEFAULT_ROUTE),a.resolve(e))},function(t){t=t||"authenticationFailed",O.a.sendEvent(h.a.EVENT_DISPLAY_MESSAGE_REQUEST,t),e&&e.failureCallback&&e.failureCallback(t),a.reject(t)}),a},E=t(379),x=t(23),R=t(37);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function I(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?L(Object(t),!0).forEach(function(a){F(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function F(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=U(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==U(a)?a:a+""}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function A(e){x.a.routeTo(x.a.configuration.routes.loginFailure,{args:[e],trigger:!0})}function N(e,a){return r.a.some(e,function(e){return e.type===a})}var Q=m.a.extend({template:"openam/RESTLoginTemplate",baseTemplate:"common/LoginBaseTemplate",data:{},events:{"click input[type=submit]":"formSubmit"},handleExistingSession:function(e){var a=this.$el;E.a.getLoggedUser(function(t,n){if(Object(k.a)())window.location.replace("#switchRealm/".concat(Object(y.a)()));else{if(b.a.setProperty("loggedUser",t),Object(p.c)(e.successUrl))return Object(p.e)(e.successUrl),window.location.href=Object(p.f)(),a.empty(),!1;Object(p.d)(),C.a.removeAnonymousDefaultHeaders(),b.a.globalData.xuiUserSessionValidationEnabled&&T.a.start(P.a,n),x.a.navigate("",{trigger:!0})}},function(){Object(w.a)()})},autoLogin:function(){var e,a={},t=b.a.globalData.auth;r.a.each(r.a.keys(t.urlParams),function(n){n.indexOf("IDToken")>-1&&(e=parseInt(n.substring(7),10)-1,a["callback_".concat(e)]=t.urlParams["IDToken".concat(n.substring(7))])}),t.autoLoginAttempts=1,j(a)},isZeroPageLoginAllowed:function(){var e=document.referrer,a=b.a.globalData.zeroPageLogin.refererWhitelist;return!!b.a.globalData.zeroPageLogin.enabled&&(e?!a||!a.length||a.indexOf(e)>-1:b.a.globalData.zeroPageLogin.allowedWithoutReferer)},formSubmit:function(e){var a;e.preventDefault(),o()(e.currentTarget).prop("disabled",!0);var t=new s.a(this.$el[0]);t[o()(e.target).attr("name")]=o()(e.target).attr("index"),0!==this.$el.find("[name=loginRemember]:checked").length?((a=new Date).setDate(a.getDate()+20),v.a.setCookie("login",this.$el.find("input[type=text]:first").val(),a)):0!==this.$el.find("[name=loginRemember]").length&&v.a.deleteCookie("login"),this.loginRequestFunction({submitContent:t,failureCallback:function(){if(o()(e.currentTarget).prop("disabled",!1),o()("input[type='password']").val(""),b.a.globalData.auth.currentStage>1){var a=R.a.getCurrentFragmentQueryString();a&&(a="&".concat(a)),A(a)}}})},moveLegacyRealmFragmentToQuery:function(e){var a=e.realm;delete e.realm;var t="#login".concat(r.a.isEmpty(e)?"":"&".concat(Object(d.c)(e))),n="?".concat(Object(d.c)(I({realm:a},Object(d.b)(R.a.getCurrentQueryString()))));return"".concat(R.a.getCurrentPathName()).concat(n).concat(t)},getUrlWithoutNewSessionParameters:function(){var e=function(e,a){var t=Object(d.b)(e);return"newsession"===t.arg&&delete t.arg,r.a.isEmpty(t)?"":"".concat(a).concat(Object(d.c)(t))},a=e(R.a.getCurrentQueryString(),"?"),t=e(R.a.getCurrentFragmentQueryString(),"&");return"".concat(R.a.getCurrentPathName()).concat(a,"#login").concat(t)},render:function(e){var a=this,t=Object(d.b)(R.a.getCurrentFragmentQueryString());if(t.realm)location.href=this.moveLegacyRealmFragmentToQuery(t);else{var n=e?e[1]:void 0,i={},o=b.a.globalData.auth;this.data.fragmentParamString=Object(y.a)(),this.data.args=[void 0,this.data.fragmentParamString];var l=I({},t,{},Object(d.b)(R.a.getCurrentQueryString()));delete l.service,this.data.queryStringExclServiceParam="",this.data.queryStringExclServiceParam=r.a.isEmpty(l)?"":"&".concat(Object(d.c)(l)),e&&(o.additional=n,o.urlParams={},(i=this.handleParams()).IDToken1&&this.isZeroPageLoginAllowed()&&!o.autoLoginAttempts&&this.autoLogin()),f.a.getRequirements().then(function(e){if(e.hasOwnProperty("tokenId")&&"newsession"===i.arg){var t=a.getUrlWithoutNewSessionParameters();Object(w.a)().then(function(){window.location.href=t},function(){window.location.href=t})}else if(e.hasOwnProperty("tokenId"))a.handleExistingSession(e);else if(e.hasOwnProperty("type")&&"error"===e.type&&e.hasOwnProperty("message")){S.a.addMessage({type:S.a.TYPE_DANGER,message:e.message});var n=R.a.getCurrentFragmentQueryString();A(E.a.filterUrlParams(Object(d.b)(n)))}else a.loginRequestFunction=j,a.renderForm(e,i)},function(e){if(r.a.has(e,"message")&&S.a.addMessage({type:S.a.TYPE_DANGER,message:e.message}),r.a.has(e,"detail.failureUrl")&&!r.a.isEmpty(e.detail.failureUrl))window.location.href=e.detail.failureUrl;else{var a=R.a.getCurrentFragmentQueryString();A(E.a.filterUrlParams(Object(d.b)(a)))}})}},isUsernamePasswordStage:function(e){return!!r.a.includes(["DataStore1","AD1","JDBC1","LDAP1","Membership1","RADIUS1"],e.stage)||e.callbacks&&N(e.callbacks,"NameCallback")},renderForm:function(e,a){var t=this,n=r.a.clone(e),i=o.a.Deferred(),l=this;if(this.userNamePasswordStage=this.isUsernamePasswordStage(e),n.callbacks=[],r.a.each(e.callbacks,function(e){var a,i;if("RedirectCallback"===e.type)i=r.a.fromPairs(r.a.map(e.output,function(e){return[e.name,e.value]})),a=o()("<form action='".concat(i.redirectUrl,"' method='POST'></form>")),"POST"===i.redirectMethod?(r.a.each(i.redirectData,function(e,t){a.append("<input type='hidden' name='".concat(t,"' value='").concat(e,"' aria-hidden='true' />"))}),a.appendTo("body").submit()):window.location.replace(i.redirectUrl);else if("PollingWaitCallback"===e.type){var l=r.a.find(e.output,{name:"waitTime"}).value;r.a.delay(function(){t.pollingInProgress=!0,N(t.reqs.callbacks,"PollingWaitCallback")&&j()},l)}n.callbacks.push({input:{index:n.callbacks.length,name:e.input?e.input[0].name:null,value:e.input?e.input[0].value:null},output:e.output,type:e.type})}),!(N(e.callbacks,"ConfirmationCallback")||N(e.callbacks,"PollingWaitCallback")||N(e.callbacks,"RedirectCallback")||N(e.callbacks,"SuspendedTextOutputCallback"))){var s={input:{index:n.callbacks.length,name:"loginButton",value:0},output:[{name:"options",value:[g.a.t("common.user.login")]}],type:"ConfirmationCallback"};n.callbacks.push(s)}var c=e.callbacks&&!this.reqs||!r.a.isEqual(e.callbacks,this.reqs.callbacks),u=this.pollingInProgress||N(e.callbacks,"PollingWaitCallback");if(this.reqs=e,this.data.reqs=n,a.IDToken1&&1===b.a.globalData.auth.autoLoginAttempts)b.a.globalData.auth.autoLoginAttempts++;else if(c||!u){this.pollingInProgress=!1;var p=function(){(function(){var e=1===b.a.globalData.auth.currentStage&&this.userNamePasswordStage;this.data.showForgotPassword=e&&"true"===b.a.globalData.forgotPassword,this.data.showForgotUserName=e&&"true"===b.a.globalData.forgotUsername,this.data.showForgotten=this.data.showForgotPassword||this.data.showForgotUserName,this.data.showSelfRegistration=e&&"true"===b.a.globalData.selfRegistration,this.data.showRememberLogin=e,this.data.showSocialLogin=e&&!b.a.loggedUser&&!r.a.isEmpty(b.a.globalData.socialImplementations)}).call(l),l.parentRender(function(){l.prefillLoginData(),i.resolve()})};this.loadThemedTemplate("openam/authn/".concat(e.stage)).then(function(e){l.template=e,p()},function(){l.template="openam/RESTLoginTemplate",p()})}return i},prefillLoginData:function(){var e=v.a.getCookie("login");0!==this.$el.find("[name=loginRemember]").length&&e?(this.$el.find("input[type=text]:first").val(e),this.$el.find("[name=loginRemember]").attr("checked","true"),this.$el.find("[type=password]").focus()):this.$el.find(":input:not([type='radio']):not([type='checkbox']):not([type='submit']):not([type='button']):first").focus()},handleParams:function(){var e,a,t=R.a.getCurrentCompositeQueryString(),n=Object(d.b)(t);if(!n.authIndexType||"composite_advice"!==n.authIndexType){var i=r.a.find(n,function(e,a){return"resourceurl"===a.toLowerCase()});r.a.each(["authlevel","module","service","user","resource"],function(e){if(n[e]){if("resource"===e&&!i)return;var a="resource"===e?i:n[e];n.authIndexType="authlevel"===e?"level":e,n.authIndexValue=a,b.a.globalData.auth.additional+="&authIndexType=".concat("authlevel"===e?"level":e,"&authIndexValue=").concat(a)}})}return(e=n.goto)&&(a=decodeURIComponent(e)),e&&(r.a.startsWith(a,"/SSORedirect")||r.a.startsWith(a,"/SSOPOST"))&&(n.goto="".concat(h.a.context).concat(n.goto),b.a.globalData.auth.additional.replace("&goto=","&goto=".concat(h.a.context))),b.a.globalData.auth.urlParams=n,n}});u.a.registerHelper("callbackRender",function(){var e,a,t=this,n="",i="",o="";r.a.find(this.output,function(e){"prompt"===e.name&&void 0!==e.value&&e.value.length&&(i=e.value.replace(/:$/,""))});var l,s={id:(l=this.input.name,r.a.isEmpty(l)?"":r.a.camelCase(l)),index:this.input.index,value:this.input.value,prompt:i};function c(e,a){return r.a.find(u.a.partials,function(a,t){return-1!==t.indexOf("login/_".concat(e))})(r.a.merge(s,a))}switch(this.type){case"PasswordCallback":n+=c("Password");break;case"TextInputCallback":n+=c("TextInput");break;case"SuspendedTextOutputCallback":case"TextOutputCallback":"4"===(e={message:r.a.find(this.output,{name:"message"}),type:r.a.find(this.output,{name:"messageType"})}).type.value?n+=c("ScriptTextOutput",{messageValue:e.message.value}):n+=c("TextOutput",{typeValue:e.type.value,messageValue:e.message.value});break;case"ConfirmationCallback":(e=r.a.find(this.output,{name:"options"}))&&void 0!==e.value&&(a=e.value.length>1?r.a.find(this.output,{name:"defaultOption"}):{value:0},r.a.each(e.value,function(e,t){o=a&&a.value===t?"btn-primary":"btn-default",n+=c("Confirmation",{btnClass:o,key:t,option:e})}));break;case"ChoiceCallback":(e=r.a.find(this.output,{name:"choices"}))&&void 0!==e.value&&(n+=c("Choice",{values:r.a.map(e.value,function(e,a){return{active:t.input.value===a,key:a,value:e}})}));break;case"HiddenValueCallback":n+=c("HiddenValue");break;case"RedirectCallback":n+=c("Redirect");break;case"PollingWaitCallback":n+=c("PollingWait",{message:r.a.find(this.output,{name:"message"}).value});break;case"ReCaptchaCallback":n+=c("ReCaptcha",{siteKey:r.a.find(this.output,{name:"recaptchaSiteKey"}).value,apiUri:r.a.find(this.output,{name:"captchaApiUri"}).value,divClass:r.a.find(this.output,{name:"captchaDivClass"}).value});break;default:n+=c("Default")}return new u.a.SafeString(n)});a.default=new Q}}]);
//# sourceMappingURL=7.a075f87ef4.js.map